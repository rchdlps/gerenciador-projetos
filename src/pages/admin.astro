---
import DashboardLayout from "@/layouts/DashboardLayout.astro";
import { AdminDashboard } from "@/components/admin/dashboard";
import { getPageContext } from "@/lib/queries/page-context";

const ctx = await getPageContext(Astro.request.headers);
if (!ctx) return Astro.redirect("/login");

if (!ctx.isSuperAdmin) {
    return Astro.redirect("/");
}
---

<DashboardLayout
    title="Admin - GestÃ£o de Secretarias"
    session={ctx.session}
    orgSessionData={ctx.orgSessionData}
>
    <AdminDashboard client:load />
</DashboardLayout>
